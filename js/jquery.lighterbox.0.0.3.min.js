!function(t,o,e){function i(o,e){n=t(o),this.options=t.extend({},a,e),this.init()}var n,s="lighterbox",a={overlayColor:"white",overlayOpacity:"0.95",animateSpeed:200,baseCss:{width:"auto",height:"auto","max-width":"100%","max-height":"100%",position:"fixed",top:"50%",right:"50%","z-index":"9998",opacity:"0"},loaderCss:{width:"30px",height:"30px",display:"block",position:"fixed",left:"50%",bottom:"50%","margin-left":"-15px","z-index":"9997",background:"url('https://s3-us-west-2.amazonaws.com/nycg/loader-60x60.gif') no-repeat","background-size":"30px"},closeCss:{"-webkit-tap-highlight-color":"rgba(0,0,0,0)",cursor:"pointer","font-size":"2em",color:"#000",background:"#fff",padding:"0 0.3em",position:"fixed",top:"0",right:"0","z-index":"9999",opacity:"0"},captionCss:{width:"100%","text-align":"center",background:"#000",color:"#fff",position:"fixed",bottom:"0",left:"0","z-index":"9999",opacity:"0"},touch:{supportTouch:!0,touchStarted:!1,currX:0,currY:0,cachedX:0,cachedY:0}};i.prototype.getPointerEvent=function(t){return t.originalEvent.targetTouches?t.originalEvent.targetTouches[0]:t},i.prototype.tap=function(t,o,e){var i=this;"touchend"===o.type&&i.options.touch.supportTouch?i.options.touch.cachedX!==i.options.touch.currX||i.options.touch.touchStarted||i.options.touch.cachedY!==i.options.touch.currY||e.call():e.call()},i.prototype.trackTouchEvents=function(){var o=this,e=t("body");e.on("touchstart",function(t){var e=o.getPointerEvent(t);o.options.touch.cachedX=o.options.touch.currX=e.pageX,o.options.touch.cachedY=o.options.touch.currY=e.pageY,o.options.touch.touchStarted=!0}),e.on("touchend",function(){o.options.touch.touchStarted=!1}),e.on("touchmove",function(t){var e=o.getPointerEvent(t);o.options.touch.currX=e.pageX,o.options.touch.currY=e.pageY})},i.prototype.destroy=function(t){for(var o=this,e=o.options.animateSpeed+100,i=0;i<t.length;i++)t[i].css("opacity",0);setTimeout(function(){for(var o=0;o<t.length;o++)t[o].remove()},e)},i.prototype.reposition=function(t,o){var e=function(){var e=o.height()>0?o.height():0,i=-(Math.floor(parseInt(t.height())/2)+e/2),n=-Math.floor(parseInt(t.width())/2);t.css({"margin-top":i+"px","margin-right":n+"px"})};return{init:e}},i.prototype.open=function(i){var n=this,a=i.find("."+s+"-title").text(),c=i.find("."+s+"-desc").text(),r="white"==n.options.overlayColor?"255, 255, 255":"0, 0, 0",p=e.createElement("div"),d=t(p),h=e.createElement("img"),u=t(h),l=e.createElement("div"),f=t(l),g=e.createElement("div"),m=t(g),v=e.createElement("div"),y=t(v),b=!1;n.options.baseCss["-webkit-transition"]="all "+n.options.animateSpeed+"ms ease-in-out",n.options.baseCss["-moz-transition"]="all "+n.options.animateSpeed+"ms ease-in-out",n.options.baseCss["-o-transition"]="all "+n.options.animateSpeed+"ms ease-in-out",n.options.baseCss.transition="all "+n.options.animateSpeed+"ms ease-in-out",u.addClass(s+"-img").attr("src",i.attr("href")).css(n.options.baseCss).appendTo("body");var C={};for(var x in n.options.baseCss)C[x]=n.options.baseCss[x];C.width="100%",C.height="100%",C.top="0",C.left="0",C["z-index"]="9997",C.background="rgb("+r+")",d.addClass(s+"-overlay").css(C).appendTo(t("body")).add(y).on("click touchend",function(){n.destroy([d,u,y,m]),b!==!1&&t(o).off("resize",b.init)}),f.addClass(s+"-loader").css(n.options.loaderCss).appendTo(d),"white"!=n.options.overlayColor&&(n.options.closeCss.color="#fff"),y.addClass(s+"-close").html("x").css(n.options.closeCss).appendTo("body"),"white"!=n.options.overlayColor&&(n.options.captionCss.color="#000",n.options.captionCss.background="#fff"),m.addClass(s+"-caption").html("<p class='"+s+"-overlay-title'>"+a+"</p><p class='"+s+"-overlay-desc'>"+c+"</p>").css(n.options.captionCss).appendTo("body"),m.find("."+s+"-overlay-title").css({margin:"0.5em"}),m.find("."+s+"-overlay-desc").css({margin:"0 0.5em 0.5em"}),u.load(function(){b=new n.reposition(t(this),m),b.init(),t(o).resize(b.init),n.destroy([f]),setTimeout(function(){u.css("opacity",1)},n.options.animateSpeed)}),setTimeout(function(){d.add(m).css("opacity",n.options.overlayOpacity),y.css("opacity","0.3")},1)},i.prototype.init=function(){var o=this;o.options.touch.supportTouch&&o.trackTouchEvents(),n.on("click touchend",function(e){e.preventDefault(),e.stopPropagation();var i=t(this);o.tap(t(this),e,function(){o.open(i,e)})})},t.fn[s]=function(o){return this.each(function(){t.data(this,"plugin_"+s)||t.data(this,"plugin_"+s,new i(this,o))})}}(jQuery,window,document);